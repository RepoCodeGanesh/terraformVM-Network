# Production-Grade Terraform Pipeline
# Use azure-pipelines.prod.yml for the latest version with:
# - Multi-environment support (dev/staging/prod)
# - Validation & security checks
# - Cost estimation
# - Manual approval gates
# - Workspace management

trigger:
  branches:
    include:
      - main
  paths:
    include:
      - '**/*.tf'
      - 'azure-pipelines.yml'
      - 'azure-pipelines.prod.yml'

pool:
  vmImage: 'ubuntu-latest'

jobs:
- job: NotifyUpgrade
  displayName: Upgrade to Production Pipeline
  steps:
  - script: |
      echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
      echo "â•‘ ğŸš€ Production Pipeline Configured                             â•‘"
      echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
      echo "â•‘ The new production pipeline is now available:                  â•‘"
      echo "â•‘                                                                â•‘"
      echo "â•‘ ğŸ“„ File: azure-pipelines.prod.yml                             â•‘"
      echo "â•‘                                                                â•‘"
      echo "â•‘ âœ¨ Features:                                                   â•‘"
      echo "â•‘    â€¢ Multi-environment support (dev/staging/prod)             â•‘"
      echo "â•‘    â€¢ Validation & security scans (TFSec)                       â•‘"
      echo "â•‘    â€¢ Cost estimation (Infracost)                               â•‘"
      echo "â•‘    â€¢ Manual approval gates                                     â•‘"
      echo "â•‘    â€¢ Terraform workspace management                           â•‘"
      echo "â•‘    â€¢ Categorized plan summaries                               â•‘"
      echo "â•‘    â€¢ Separate tfvars per environment                          â•‘"
      echo "â•‘                                                                â•‘"
      echo "â•‘ ğŸ“‹ Next Steps:                                                 â•‘"
      echo "â•‘    1. In Azure DevOps, create a new pipeline                   â•‘"
      echo "â•‘    2. Point it to azure-pipelines.prod.yml                     â•‘"
      echo "â•‘    3. Create environments for approval gates:                  â•‘"
      echo "â•‘       - terraform-dev                                         â•‘"
      echo "â•‘       - terraform-staging                                     â•‘"
      echo "â•‘       - terraform-prod                                        â•‘"
      echo "â•‘       - terraform-prod-destroy                                â•‘"
      echo "â•‘                                                                â•‘"
      echo "â•‘ ğŸ”‘ Requirements:                                               â•‘"
      echo "â•‘    â€¢ Create terraform.dev.tfvars file                          â•‘"
      echo "â•‘    â€¢ Create terraform.staging.tfvars file                      â•‘"
      echo "â•‘    â€¢ Create terraform.prod.tfvars file                         â•‘"
      echo "â•‘                                                                â•‘"
      echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    displayName: 'Display Production Pipeline Info'
